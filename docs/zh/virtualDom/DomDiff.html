<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dom Diff | 前端知识点总结</title>
    <meta name="description" content="一字，一言，一语，一编程">
    <link rel="icon" href="/study/logo.png">
  <link rel="manifest" href="/study/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/study/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/study/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/study/assets/css/styles.2a8396d9.css" as="style"><link rel="preload" href="/study/assets/js/app.2a8396d9.js" as="script"><link rel="preload" href="/study/assets/js/1.4667c94a.js" as="script"><link rel="prefetch" href="/study/assets/css/2.styles.18e6a707.css"><link rel="prefetch" href="/study/assets/css/3.styles.1323ce94.css"><link rel="prefetch" href="/study/assets/css/4.styles.949548c6.css"><link rel="prefetch" href="/study/assets/css/5.styles.cc988892.css"><link rel="prefetch" href="/study/assets/css/6.styles.c01b2c90.css"><link rel="prefetch" href="/study/assets/css/7.styles.22bd3311.css"><link rel="prefetch" href="/study/assets/css/9.styles.a6c1bd7b.css"><link rel="prefetch" href="/study/assets/js/10.d9b5e650.js"><link rel="prefetch" href="/study/assets/js/11.f5b4133b.js"><link rel="prefetch" href="/study/assets/js/12.f3ba7b30.js"><link rel="prefetch" href="/study/assets/js/13.6f910e11.js"><link rel="prefetch" href="/study/assets/js/14.5e60c9c4.js"><link rel="prefetch" href="/study/assets/js/15.81ea7b0c.js"><link rel="prefetch" href="/study/assets/js/16.deccd4c6.js"><link rel="prefetch" href="/study/assets/js/17.a73d0fc4.js"><link rel="prefetch" href="/study/assets/js/18.5674363e.js"><link rel="prefetch" href="/study/assets/js/19.66f4cb1d.js"><link rel="prefetch" href="/study/assets/js/2.18e6a707.js"><link rel="prefetch" href="/study/assets/js/20.4c819a55.js"><link rel="prefetch" href="/study/assets/js/21.b53f17a9.js"><link rel="prefetch" href="/study/assets/js/22.cbf4bd00.js"><link rel="prefetch" href="/study/assets/js/23.ad4342b4.js"><link rel="prefetch" href="/study/assets/js/24.11de8f74.js"><link rel="prefetch" href="/study/assets/js/25.c6945d02.js"><link rel="prefetch" href="/study/assets/js/26.28ce93ee.js"><link rel="prefetch" href="/study/assets/js/27.c99d7551.js"><link rel="prefetch" href="/study/assets/js/28.0ea30cf9.js"><link rel="prefetch" href="/study/assets/js/29.a568b7c7.js"><link rel="prefetch" href="/study/assets/js/3.1323ce94.js"><link rel="prefetch" href="/study/assets/js/30.f7d94696.js"><link rel="prefetch" href="/study/assets/js/31.63d46ca4.js"><link rel="prefetch" href="/study/assets/js/32.c2e687e6.js"><link rel="prefetch" href="/study/assets/js/33.fafce54f.js"><link rel="prefetch" href="/study/assets/js/34.b20b66e9.js"><link rel="prefetch" href="/study/assets/js/35.f3a4a824.js"><link rel="prefetch" href="/study/assets/js/36.b0cc4e74.js"><link rel="prefetch" href="/study/assets/js/37.82761e80.js"><link rel="prefetch" href="/study/assets/js/38.22acc82b.js"><link rel="prefetch" href="/study/assets/js/39.3b88bc1b.js"><link rel="prefetch" href="/study/assets/js/4.949548c6.js"><link rel="prefetch" href="/study/assets/js/40.c0d45a07.js"><link rel="prefetch" href="/study/assets/js/41.d9097a97.js"><link rel="prefetch" href="/study/assets/js/42.fc960740.js"><link rel="prefetch" href="/study/assets/js/43.eba59e59.js"><link rel="prefetch" href="/study/assets/js/44.a13f46ba.js"><link rel="prefetch" href="/study/assets/js/45.f8f41226.js"><link rel="prefetch" href="/study/assets/js/46.0bb0d9c1.js"><link rel="prefetch" href="/study/assets/js/47.b0d11886.js"><link rel="prefetch" href="/study/assets/js/48.a4363174.js"><link rel="prefetch" href="/study/assets/js/49.b26ba994.js"><link rel="prefetch" href="/study/assets/js/5.cc988892.js"><link rel="prefetch" href="/study/assets/js/50.e08d8ea6.js"><link rel="prefetch" href="/study/assets/js/51.a9c5fe20.js"><link rel="prefetch" href="/study/assets/js/52.cdbf5b72.js"><link rel="prefetch" href="/study/assets/js/53.10e9d11c.js"><link rel="prefetch" href="/study/assets/js/54.9c341e49.js"><link rel="prefetch" href="/study/assets/js/55.b4c3989a.js"><link rel="prefetch" href="/study/assets/js/56.d322f524.js"><link rel="prefetch" href="/study/assets/js/57.315feabf.js"><link rel="prefetch" href="/study/assets/js/58.567bdc6e.js"><link rel="prefetch" href="/study/assets/js/59.7d242b70.js"><link rel="prefetch" href="/study/assets/js/6.c01b2c90.js"><link rel="prefetch" href="/study/assets/js/60.e6980e1c.js"><link rel="prefetch" href="/study/assets/js/61.acea4679.js"><link rel="prefetch" href="/study/assets/js/62.7a505017.js"><link rel="prefetch" href="/study/assets/js/63.8d32b808.js"><link rel="prefetch" href="/study/assets/js/64.35fa5773.js"><link rel="prefetch" href="/study/assets/js/65.4856d57e.js"><link rel="prefetch" href="/study/assets/js/66.d298227d.js"><link rel="prefetch" href="/study/assets/js/67.5ae14782.js"><link rel="prefetch" href="/study/assets/js/68.d77655ad.js"><link rel="prefetch" href="/study/assets/js/69.e165139c.js"><link rel="prefetch" href="/study/assets/js/7.22bd3311.js"><link rel="prefetch" href="/study/assets/js/70.b2a217ce.js"><link rel="prefetch" href="/study/assets/js/71.ebf80bb5.js"><link rel="prefetch" href="/study/assets/js/72.d92d4dc2.js"><link rel="prefetch" href="/study/assets/js/73.d9c41ad2.js"><link rel="prefetch" href="/study/assets/js/74.9f0e6da0.js"><link rel="prefetch" href="/study/assets/js/75.fbc16338.js"><link rel="prefetch" href="/study/assets/js/76.ee8ef39c.js"><link rel="prefetch" href="/study/assets/js/8.6372ae62.js"><link rel="prefetch" href="/study/assets/js/9.a6c1bd7b.js">
    <link rel="stylesheet" href="/study/assets/css/styles.2a8396d9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/study/" class="home-link router-link-active"><!----> <span class="site-name">前端知识点总结</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/study/zh/standard/Start.html" class="nav-link">快速搭建开发环境</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/zh/algorithm/Charpter4.html" class="nav-link">编程基本功</a></li><li class="dropdown-item"><!----> <a href="/study/zh/algorithm/Charpter5.html" class="nav-link">数学趣题(一)</a></li><li class="dropdown-item"><!----> <a href="/study/zh/algorithm/Charpter6.html" class="nav-link">数学趣题(二)</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">项目相关</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/zh/standard/Standard.html" class="nav-link">前端规范</a></li><li class="dropdown-item"><!----> <a href="/study/zh/standard/Project.html" class="nav-link">项目流程</a></li><li class="dropdown-item"><!----> <a href="/study/zh/standard/Cooperation.html" class="nav-link">前后端交互</a></li><li class="dropdown-item"><!----> <a href="/study/zh/standard/Compatibility.html" class="nav-link">移动端兼容问题</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">知名公司面试题</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/zh/interview/index.html" class="nav-link">面试必看</a></li><li class="dropdown-item"><!----> <a href="/study/zh/interview/ali.html" class="nav-link">阿里巴巴</a></li><li class="dropdown-item"><!----> <a href="/study/zh/interview/longhu.html" class="nav-link">龙湖地产</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">知识点笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/zh/interface/Mind.html" class="nav-link">在线思维导图</a></li><li class="dropdown-item"><!----> <a href="/study/zh/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/study/zh/react/" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/study/zh/miniapp/" class="nav-link">小程序</a></li><li class="dropdown-item"><!----> <a href="/study/zh/interface/Yuedu.html" class="nav-link">悦读管理后台</a></li><li class="dropdown-item"><!----> <a href="/study/zh/interface/BlackMarket.html" class="nav-link">BlackMarket</a></li><li class="dropdown-item"><!----> <a href="/study/zh/interface/TouTiao.html" class="nav-link">TouTiao</a></li><li class="dropdown-item"><!----> <a href="/study/zh/virtualDom/DomDiff.html" class="nav-link router-link-exact-active router-link-active">virtualDom</a></li></ul></div></div> <a href="https://github.com/raneenana/study" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/study/zh/standard/Start.html" class="nav-link">快速搭建开发环境</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/zh/algorithm/Charpter4.html" class="nav-link">编程基本功</a></li><li class="dropdown-item"><!----> <a href="/study/zh/algorithm/Charpter5.html" class="nav-link">数学趣题(一)</a></li><li class="dropdown-item"><!----> <a href="/study/zh/algorithm/Charpter6.html" class="nav-link">数学趣题(二)</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">项目相关</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/zh/standard/Standard.html" class="nav-link">前端规范</a></li><li class="dropdown-item"><!----> <a href="/study/zh/standard/Project.html" class="nav-link">项目流程</a></li><li class="dropdown-item"><!----> <a href="/study/zh/standard/Cooperation.html" class="nav-link">前后端交互</a></li><li class="dropdown-item"><!----> <a href="/study/zh/standard/Compatibility.html" class="nav-link">移动端兼容问题</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">知名公司面试题</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/zh/interview/index.html" class="nav-link">面试必看</a></li><li class="dropdown-item"><!----> <a href="/study/zh/interview/ali.html" class="nav-link">阿里巴巴</a></li><li class="dropdown-item"><!----> <a href="/study/zh/interview/longhu.html" class="nav-link">龙湖地产</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">知识点笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study/zh/interface/Mind.html" class="nav-link">在线思维导图</a></li><li class="dropdown-item"><!----> <a href="/study/zh/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/study/zh/react/" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/study/zh/miniapp/" class="nav-link">小程序</a></li><li class="dropdown-item"><!----> <a href="/study/zh/interface/Yuedu.html" class="nav-link">悦读管理后台</a></li><li class="dropdown-item"><!----> <a href="/study/zh/interface/BlackMarket.html" class="nav-link">BlackMarket</a></li><li class="dropdown-item"><!----> <a href="/study/zh/interface/TouTiao.html" class="nav-link">TouTiao</a></li><li class="dropdown-item"><!----> <a href="/study/zh/virtualDom/DomDiff.html" class="nav-link router-link-exact-active router-link-active">virtualDom</a></li></ul></div></div> <a href="https://github.com/raneenana/study" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <div class="carbon-ads"></div> <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>virtualDom</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/study/zh/virtualDom/DomDiff.html" class="active sidebar-link">Dom Diff</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="dom-diff"><a href="#dom-diff" aria-hidden="true" class="header-anchor">#</a> Dom Diff</h1> <h3 id="什么是虚拟dom"><a href="#什么是虚拟dom" aria-hidden="true" class="header-anchor">#</a> 什么是虚拟DOM</h3> <p>当我们更新了state中的值的时候，React会去调用render()方法来重新渲染整个组件，React实现了一个Virtual DOM，组件的真实DOM结构和Virtual DOM之间有一个映射的关系，React在虚拟DOM上实现了一个diff算法，当render()去重新渲染组件的时候，diff会找到需要变更的DOM，然后再把修改更新到浏览器上面的真实DOM上，所以，React并不是渲染了整个DOM树，Virtual DOM就是JS数据结构，所以比原生的DOM快得多。</p> <h3 id="为什么要用虚拟dom"><a href="#为什么要用虚拟dom" aria-hidden="true" class="header-anchor">#</a> 为什么要用虚拟DOM</h3> <p>频繁操作DOM会造成页面卡顿影响用户体验<br>
虚拟DOM比真实DOM要快很多<br>
更新时，虚拟DOM不会直接更新，会和之前的进行比较，将不同的地方进行重新渲染，避免了无所谓的渲染</p> <h3 id="虚拟dom的基本执行步骤"><a href="#虚拟dom的基本执行步骤" aria-hidden="true" class="header-anchor">#</a> 虚拟DOM的基本执行步骤</h3> <ul><li>1，用JS构建出一颗虚拟DOM树，再用虚拟的DOM树去构建出一个真实的DOM树，插入到文档中</li> <li>2，当树的状态发生改变的时候，重新构建出一颗新的DOM，并将新的树和旧的树进行对比，并记录两棵树的差异</li> <li>3，把不同的地方重新渲染，相同的地方不会重新渲染
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAiIAAADaCAQAAAAx4+H8AAAAAmJLR0QA/4ePzL8AABS9SURBVHja7d15eFTV/cfxd0IICUlMJNCkrAYMsimGwaCAEooYaov5YX3UVgWLbVpF01q7+KOASou0/dm64UKqWKhbNeoTKIr0sWpREGUENIoCyiJgWITQxCyQZH5/zJ1hJplkZnKSuVk+L5/HTO7cuXPmO/d+5pwzN9wolwsRkRaLtrsBItKxKURExIhCRESMKERExIhCRESMKERExIhCRESMKERExIhCRESMKERExIhCRESMxARf5Sgr2MgeauxuaxDJDOCH5NjdDJEuJirYH+Ad5Eb2cxqxRNnd1iBcVHOc6cyjm91NEelCgvZEnuMLLmQ2mfSwu61B1LCVP7GSqxhmd1NEupCgcyLvEsfNjGr3EQI9yCYX2Gh3Q0S6lKAhspdoBtvdypANBUrtboRIl9LJvp05HThmdyNEupROFiIiEmkKERExohARESMKERExohARESMKERExohARESMKERExohARESMKERExohARESMKERExohARESMKERExohARESMKERExohARESMKERExohARESMKERExohARESMKEREx0iYhsp5l1AJQz1es47dst/t1ikgbCeGC3uF5gOUAPMQ0RvEAIxnP9WRQxs8oAVKZykzSAKhnA4+wjSSmcz2pgJN8fsOV1rZqKWQj95Nid5VEpEmtHiI/Jo3pxPIc49nK7eR570mmiAwq2cDtzGMILopYz90MoIY13MGd9AYGsp5ckgEopYQEuyskIs1q9eFMPGfyBu+TwqCA9/dkCvk8RiX7eYvbGUgUceThoBgXMJRU3gHAxVtM5HS7KyQizWrlnohn0ALwEBMpYiEAs5jps9YoijnIZwy2hjUQxViepBKIYSrFXEhPjrCF2Xxkd4VEpFmtHCIpLAd28TqzgWIWkEshM0mhzGet7sRQxtdEE+VdlkgVJwHIBErI5n0y6WN3fUQkiDaeWA0cAlVU0IsD1OPyxkgFyfQAIIEcXiGDtfzUJ2REpH1q9RCZTAKTWE060/kHqQHXKSGRNE6wkoOkA+BiE5nEW/c7eJmXSGEQlXbXR0SCaOWJ1So2kEc3khjBag7Rr9EalbzKMmYTRwYOFrMXF5UU4+RS7zq9mcDjTCHW7uqISFCt3BOJJx84SC1nU8GX9LJOOgM4zhVAKjO4h1Qghtm8xly2kcoM7vLrtYxnMyPtro2IhKDVhzPHuZVt/J5avuByYrwhkmLNlfg/eS65fkscOADoz2LrUYvsrpCINKvVQySZZdYt93mncRTY/RpFpA3pD/BExIhCRESMKERExIhCRESMKERExIhCRESMKERExIhCRESMKERExIhCRESMKERExIhCRESMKERExIhCRESMKERExIhCRESMKERExIhCRESMKERExIhCRESMKERExIhCRESMdLIQOQ4k290IkS4laIj0p569drcyZDuAvnY3QqRLCXrxqvPYwVJuoH+7vzJuBR+wFqxr6IWrnGfYxB6q7X4ZIRlMNje0+3fEl+rbeWsS5XI1/9B9zOEQafRo9yOfOso5Qi530D3sx5aTz3a7X0CYhvCc3U0ImerbWOepSdCeSH8e4imcfEGN3a8giNPoRwGTWxAh8DTbGc4tjCbO7pcRkq3czwc80GEuUar6duaaBO2JtJVJwJv2VsXHDWxhBSPtbkYYnBSQwZN2NyNEqm9jnacm7X2MEiE7oUO9nTCKGD63uxEhU30b6zw1UYh0UD2g3Q8wOzLVt7GmaqIQEREjChERMaIQEREjChERMaIQEREjChERMaIQEREjChERMaIQEREjChERMaIQEREjChERMaIQEREjChERMaIQEREjChERMaIQEREjChERMaIQEREjQS8Z0Vbaz7/0LiIm1BORdqgYp91NkJDZ1hPxtYvXmQ0sYzIZADzABL/LYdaxmmpm0J2T/AO4iu7ALm6m1G9LhU1eRLOUUvrShyjDth7gGS4nA/iMJ7mOwVZ7l/utNY357f6SRE7yAyx1V3AHL1FAHODiv+xkNRczPsj2auhu+JlUzMIASxeQZ92qo4ixDLG7cCGro75Fl1ILpJzn+QFxfjUqxNFozwOYRT6/Y02j5e69spa/km0dJyc5yEY+4eckGLTNhhA5degXhnjdXE+h/uhdci+zKAAmcqvPwVrczDbe5e90ZxiXMILTDFv+tHfJStJZQkaD11LGCuvnzygBUpnKTNIAqGcDj7CNJKZzPanWWn1YSE9vS2/jvhZeUTgcDu+nvZN93gP11KH8D0ZxLfPIZBx5jAi6vXfYz0BG0KvFLcrztqKY/gEq0I2+vMKNdLN+r7YOlSTG8yMrzl18zMNsIpoc5tDfWmsP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" alt="Alt text"></li></ul> <h3 id="diff算法解析"><a href="#diff算法解析" aria-hidden="true" class="header-anchor">#</a> DIFF算法解析</h3> <p><img src="/study/assets/img/1212.fa0a68eb.png" alt="Alt text"></p> <h3 id="diff算法在执行时有三个维度"><a href="#diff算法在执行时有三个维度" aria-hidden="true" class="header-anchor">#</a> DIFF算法在执行时有三个维度</h3> <h4 id="tree-diff"><a href="#tree-diff" aria-hidden="true" class="header-anchor">#</a> Tree DIFF</h4> <p><img src="/study/assets/img/1213.4ee8867c.png" alt="Alt text">
Tree DIFF是对树的每一层进行遍历，如果某组件不存在了，则会直接销毁。如图所示，左边是旧属，右边是新属，第一层组件一模一样不会发生变化；第二层进入Component DIFF，组件类型相同然后继续比较下去，发现A组件没有，所以直接删掉A、B、C组件；最后重新创建A、B、C组件。</p> <h4 id="component-diff"><a href="#component-diff" aria-hidden="true" class="header-anchor">#</a> Component DIFF</h4> <p><img src="/study/assets/img/1214.6300b133.png" alt="Alt text">
Component DIFF是对树的每一层进行遍历如果组件不同，可以直接进行删除然后在替换
第一层中的组件一样，不发生改变，进入第二层Component Diff，左侧组件一模一样，不发生改变，右侧组件不一样，对于不同的组件可以直接删除替换</p> <h4 id="element-diff"><a href="#element-diff" aria-hidden="true" class="header-anchor">#</a> Element DIFF</h4> <p><img src="/study/assets/img/1215.7872fbeb.png" alt="Alt text">
Element DIFF紧接着以上统一类型组件继续比较下去，常见类型就是列表。同一个列表由旧变新有三种行为，插入、移动和删除，它的比较策略是对于每一个列表指定key，先将所有列表遍历一遍，确定要新增和删除的，再确定需要移动的。如图所示，第一步将D删掉，第二步增加E，再次执行时A和B只需要移动位置即可。</p> <p>执行时按顺序依次执行，它们的差异仅仅因为DIFF粒度不同、执行先后顺序不同</p> <div class="language- extra-class"><pre class="language-text"><code>var objA = {
  el: 'div',
  class: 'A',
  children: [{
        el: 'div',
        class: 'B',
        children: [{
            el: 'div',
            class: 'D',
          },{
            el: 'div',
            class: 'E',
          }]
      },{
        el: 'div',
        class: 'C',
        children: [{
            el: 'div',
            class: 'F',
          },{
            el: 'div',
            class: 'G',
          }]
      }]
}
var objB = {
  el: 'div',
  class: 'A',
  children: [{
        el: 'div',
        class: 'C',
        children: [{
            el: 'div',
            class: 'D',
          },{
            el: 'div',
            class: 'G',
          }]
      },{
        el: 'div',
        class: 'B',
        children: [{
            el: 'div',
            class: 'E',
          },{
            el: 'div',
            class: 'F',
          }]
      }]
}
function difference(old,new) {

}
</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/raneenana/study/edit/master/src/zh/virtualDom/DomDiff.md" target="_blank" rel="noopener noreferrer">帮助我们改进内容</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2019-5-8 09:49:50</span></div></div> <!----> <div class="bsa-cpc-wrapper"><div class="bsa-cpc"></div></div></div> <!----></div></div>
    <script src="/study/assets/js/app.2a8396d9.js" defer></script><script src="/study/assets/js/1.4667c94a.js" defer></script>
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?c3446600de53c605ba4f6c792e47dff9";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  </body>
</html>
